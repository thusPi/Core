function submitAndCreateDevice(){let e={};$("input[data-setting], .input[data-setting]").each((function(t,n){let i=(n=$(n)).attr("data-setting");e[i]=n.val()}))}function updateDeviceSettings(e,t=!1){"group"in e&&setDropdownSearchValue("device_group",e.group,t),"analytics_support"in e&&1==e.analytics_support?$('.device-setting[data-setting="draw_graphs"]').removeClass("hidden"):$('.device-setting[data-setting="draw_graphs"]').addClass("hidden")}function loadHandlerOptions(e,t=!1){"none"!=e&&(handler_manifest_api=`/api/get/device_handler_manifest.php?handler=${e}`,$.get(handler_manifest_api,(function(e){try{if(!0!==(e=JSON.parse(e)).success)throw"Api returned invalid response";{let n=JSON.parse(e.message),i=$('.device-setting[data-setting="device_options"]'),a=i.find(".device-options-inner"),d=i.find(".device-option-template");i.addClass("hidden"),"options"in n&&(a.find(".device-option").remove(),$.each(n.options,(function(e,t){i.removeClass("hidden");let n=d.clone();a.append(n);let o=n.find(".option-key span"),s=n.find(".option-key .tooltip");if(!("note"in t)&&"type"in t){let n=min=max="";switch("length"in t&&(n=` (${t.length} digits long)`),"min"in t&&"max"in t?(min=` between ${t.min}`,max=` and ${t.max}`):"min"in t?min=` above ${t.min}`:"max"in t&&(max=` below ${t.max}`),t.type){case"integer":t.note=`An integer${n}${min}${max}.`;break;case"number":t.note=`A number${n}${min}${max}.`;break;case"ip":t.note="A valid IP address";break;case"alphanumeric":"filter"==e&&(t.note="Used for filtering the data wanted. Multiple filters can be seperated with an ampersand (&).")}}"note"in t?s.attr("data-tooltip",t.note).css({display:""}):s.removeAttr("data-tooltip").hide();let r=n.find(".option-value");o.text(e),r.attr("placeholder",t.default).attr("data-type",t.type),"min"in t&&r.attr("data-min",t.min),"max"in t&&r.attr("data-max",t.max),"length"in t&&r.attr("data-length",t.length),n.removeClass("device-option-template").addClass("device-option").show()}))),1==t&&updateDeviceSettings(n,!0)}}catch(e){}})))}$(document).on("submit","form#form-edit-device",(function(e){e.preventDefault();submitAndCreateDevice()}));