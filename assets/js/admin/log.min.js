var requestingLogs=!1;function toggleLogCategory(e){setTimeout((()=>{let e=getInactiveLogCategories();return $(".log-items").attr("data-hide-categories",e.join(",")),saveState("log_categories_inactive",e.join(","))}),1)}function getInactiveLogCategories(){let e=[];return $(".log-items-category-filter .btn:not(.active)").each((function(){e.push($(this).attr("data-category"))})),e}function requestMoreLogs(e=25){let t=$(".log-item").last(),o=parseInt(t.attr("data-index"))-1;o>=0&&requestLogs(o-e,o)}async function refreshLogs(e=25){let t=$(".log-item:not(#log-item-template)").slice(0,e),o=parseInt($(".log-item:not(#log-item-template)").first().attr("data-at"));if(o>0){return await requestLogs(void 0,void 0,e,!0,o,"prepend")&&(throwSuccess("Succesfully refreshed top logs."),t.remove()),!1}}function refreshLogsLoop(){"admin/log/main"==thusPi.page.current()&&(refreshLogs(),setTimeout((()=>{refreshLogsLoop()}),1500))}function requestLogs(e=null,t=null,o=null,i=!0,n=0,a="append"){requestingLogs=!0,thusPi.api.call("logs-get",{latest:o,min:e,max:t}).then((e=>{})).catch((()=>{}))}function printLogMessage(e="",t="",o="info",i=0,n="",a=0,r="append",l=!1){let g=t.replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(",",",<wbr />");return $log_item=$(".log-item#log-item-template").clone(),$log_item.removeAttr("id"),$log_item.find(".log-item-time").text(n),$log_item.find(".log-item-title").text(e+": "),$log_item.find(".log-item-content").html(g),$log_item.attr("data-category",o).attr("data-at",i).attr("data-index",a),$log_item.attr("data-page-search",`${n} ${e}: ${t}`),"append"==r?$log_item.appendTo(".log-items"):"prepend"==r&&$log_item.prependTo(".log-items"),l&&($log_item.addClass("log-item-new"),setTimeout((()=>{$log_item.removeClass("log-item-new")}),300)),!1}function sortLogMessages(e,t){return e.index.toString().localeCompare(t.index.toString())}function sortLogMessagesInverted(e,t){return t.index.toString().localeCompare(e.index.toString())}document.addEventListener("scroll",(function(e){if("admin/log/main"==thusPi.page.current()){let t=e.target;if(t.classList.contains("log-items")){let e=t.scrollHeight,o=t.scrollTop;t.clientHeight;o>=.5*e&&!1===requestingLogs&&requestMoreLogs(),o>=e&&(t.scrollTop=o)}}}),!0),$(document).on("thusPi.ready",(function(){if("admin/log/main"==thusPi.page.current()){let e=getInactiveLogCategories();$(".log-items").attr("data-hide-categories",e.join(","))}}));